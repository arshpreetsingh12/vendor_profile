{% extends "base.html" %}
{% load static %}

 {% block css %}
<style type="text/css">
	.add-job-form{
		display: none;
	}
	.edit_job_form{
		display: none;
	}

</style>
{% endblock %}

{% block content %}

 <!-- Form section start  -->
             <section class="form-section all-page-mg">
                <div class="container">
                	
                	<ul class="nav  justify-content-center" id="myTab" role="tablist">
					  <li class="nav-item mr-2">
					    <a class="nav-link new-exist-tab new-job active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">New Job Site</a>
					  </li>
					  <li class="nav-item">
					    <a class="nav-link new-exist-tab existing-job" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Existing Job Site</a>
					  </li>
					  
					</ul>
					<div class="tab-content mt-4" id="myTabContent">
						<!-- tab 1 -->
					  <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
					  <div class="Customer-Information-form add-job-form">
					  	  	{% if messages %}
	                        	
								{% for message in messages %}
								<div class="alert text-center {% if message.tags == 'error' %}alert-danger{% else %} alert-{{ message.tags }}{% endif %}" role="alert">{{ message|safe }}</div>
								{% endfor %}
								{% endif %}
								<div class="alert-danger alert" style="text-align: center; display: none;"></div>
							<for siq_id="autopick_9165">
						
	                            <h5 class=" mb-3">Job Location</h5>
	                            <div class="row">
	                               <div class="col-md-6">
	                                  <div class="form-group">
	                                      <input type="text" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="First Name *" class="form-control" name="first_name">
	                                    </div>
	                                    <input type="hidden" name="customer_id" value="{{customer_id}}">
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group">
	                                      <input type="text" id="" aria-describedby="emailHelp" placeholder="Last Name" class="form-control" name="last_name">
	                                    </div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group"><input type="text" id="" aria-describedby="emailHelp" placeholder="Phone Number" class="form-control" name="phone_number"></div>
	                               </div>
	                               <div class="col-12">
	                                  <div class="form-group">
									    <!-- <label for="exampleFormControlTextarea1">Address</label> -->
									    <textarea class="form-control" id="exampleFormControlTextarea1" rows="4" placeholder="Address" name="address"></textarea>
									  </div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group"><input type="text" id="" aria-describedby="emailHelp" placeholder="City" class="form-control" name="city"></div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group">
	                                    <select placeholder="State" aria-label="Select Account Type" required="required" class="form-control mb-3 state" name="state">
	                                       <option value="" disabled="disabled" selected="selected" hidden="hidden">State *</option>
	                                       <option value="AL">Alabama</option>
											<option value="AK">Alaska</option>
											<option value="AZ">Arizona</option>
											<option value="AR">Arkansas</option>
											<option value="CA">California</option>
											<option value="CO">Colorado</option>
											<option value="CT">Connecticut</option>
											<option value="DE">Delaware</option>
											<option value="DC">District Of Columbia</option>
											<option value="FL">Florida</option>
											<option value="GA">Georgia</option>
											<option value="HI">Hawaii</option>
											<option value="ID">Idaho</option>
											<option value="IL">Illinois</option>
											<option value="IN">Indiana</option>
											<option value="IA">Iowa</option>
											<option value="KS">Kansas</option>
											<option value="KY">Kentucky</option>
											<option value="LA">Louisiana</option>
											<option value="ME">Maine</option>
											<option value="MD">Maryland</option>
											<option value="MA">Massachusetts</option>
											<option value="MI">Michigan</option>
											<option value="MN">Minnesota</option>
											<option value="MS">Mississippi</option>
											<option value="MO">Missouri</option>
											<option value="MT">Montana</option>
											<option value="NE">Nebraska</option>
											<option value="NV">Nevada</option>
											<option value="NH">New Hampshire</option>
											<option value="NJ">New Jersey</option>
											<option value="NM">New Mexico</option>
											<option value="NY">New York</option>
											<option value="NC">North Carolina</option>
											<option value="ND">North Dakota</option>
											<option value="OH">Ohio</option>
											<option value="OK">Oklahoma</option>
											<option value="OR">Oregon</option>
											<option value="PA">Pennsylvania</option>
											<option value="RI">Rhode Island</option>
											<option value="SC">South Carolina</option>
											<option value="SD">South Dakota</option>
											<option value="TN">Tennessee</option>
											<option value="TX">Texas</option>
											<option value="UT">Utah</option>
											<option value="VT">Vermont</option>
											<option value="VA">Virginia</option>
											<option value="WA">Washington</option>
											<option value="WV">West Virginia</option>
											<option value="WI">Wisconsin</option>
											<option value="WY">Wyoming</option>
	                                    </select>
	                                 </div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group"><input type="text" id="" aria-describedby="emailHelp" placeholder="Postal Code" class="form-control" name="post_code"></div>
	                               </div>
	                               
	                              
	                            </div>
	                            
	                      
	                        <div class="text-center"><button type="button" class="btn-success btn add-job">Save</button></div>
	                    </div>
	                      </form>


                    	<!-- <div class="text-right my-4">
                    		<button class="add-new"><i class="fa fa-plus" aria-hidden="true"></i>Add New</button>
                    	</div> -->
                    	
					  </div>
					  <!-- tab 2 -->
 					  <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
 					  	<div class="container">
					  	<form class="row">
						  <div class="col-md-3 col-sm-6 form-group">
						    <label for="exampleInputEmail1">Last Name</label>
						    <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="" name="search_last_name">
						    <!-- <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small> -->
						  </div>
						  <div class="col-md-2 col-sm-6 form-group">
						    <label for="exampleInputPassword1">Contact Number</label>
						    <input type="text" class="form-control" id="exampleInputPassword1" placeholder="" name="search_contact_number">
						  </div>
						  <div class="col-md-3 col-sm-6 form-group">
						    <label for="exampleInputPassword1">City</label>
						    <input type="text" class="form-control" id="exampleInputPassword1" placeholder="" name="search_city">
						  </div>
						  <div class="col-md-2 col-sm-6 form-group">
						    <label for="exampleInputPassword1">Zip Code</label>
						    <input type="text" class="form-control" id="exampleInputPassword1" placeholder="" name="search_zip">
						  </div>
					 
						  <button type="button" class="btn btn-primary find-job find-btn">Search</button>
						  <button type="button" class="btn btn-danger clear-field find-btn ml-2">Clear feild</button>
						</form>
						<div class="alert-danger alert" style="text-align: center; display: none;"></div>
						<div class="Customer-Information-form edit_job_form">
							
							<form method="post" action="{% url 'edit_job' %}"  siq_id="autopick_9165">
								{% csrf_token %}
	                            <h5 class=" mb-3">Job Location</h5>
	                            <div class="row">
	                               <div class="col-md-6">
	                                  <div class="form-group">
	                                      <input type="text" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="First Name *" class="form-control" name="edit_fisrt_name">
	                                       <input type="hidden" name="job_id" value="">
	                                    </div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group">
	                                      <input type="text" id="" aria-describedby="emailHelp" placeholder="Last Name" class="form-control" name="edit_last_name">
	                                    </div>
	                               </div>
	                               <div class="col-12">
									  <div class="form-group">
									    <!-- <label for="exampleFormControlTextarea1">Address</label> -->
									    <textarea class="form-control" id="exampleFormControlTextarea1" rows="4" placeholder="Address" name="edit_address"></textarea>
									  </div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group"><input type="text" id="" aria-describedby="emailHelp" placeholder="City" class="form-control" name="edit_city"></div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group">
	                                    <select placeholder="State" aria-label="Select Account Type" required="required" class="form-control mb-3" name="edit_state">
	                                       <option value="" disabled="disabled" selected="selected" hidden="hidden">State *</option>
	                                       <option value="AL">Alabama</option>
											<option value="AK">Alaska</option>
											<option value="AZ">Arizona</option>
											<option value="AR">Arkansas</option>
											<option value="CA">California</option>
											<option value="CO">Colorado</option>
											<option value="CT">Connecticut</option>
											<option value="DE">Delaware</option>
											<option value="DC">District Of Columbia</option>
											<option value="FL">Florida</option>
											<option value="GA">Georgia</option>
											<option value="HI">Hawaii</option>
											<option value="ID">Idaho</option>
											<option value="IL">Illinois</option>
											<option value="IN">Indiana</option>
											<option value="IA">Iowa</option>
											<option value="KS">Kansas</option>
											<option value="KY">Kentucky</option>
											<option value="LA">Louisiana</option>
											<option value="ME">Maine</option>
											<option value="MD">Maryland</option>
											<option value="MA">Massachusetts</option>
											<option value="MI">Michigan</option>
											<option value="MN">Minnesota</option>
											<option value="MS">Mississippi</option>
											<option value="MO">Missouri</option>
											<option value="MT">Montana</option>
											<option value="NE">Nebraska</option>
											<option value="NV">Nevada</option>
											<option value="NH">New Hampshire</option>
											<option value="NJ">New Jersey</option>
											<option value="NM">New Mexico</option>
											<option value="NY">New York</option>
											<option value="NC">North Carolina</option>
											<option value="ND">North Dakota</option>
											<option value="OH">Ohio</option>
											<option value="OK">Oklahoma</option>
											<option value="OR">Oregon</option>
											<option value="PA">Pennsylvania</option>
											<option value="RI">Rhode Island</option>
											<option value="SC">South Carolina</option>
											<option value="SD">South Dakota</option>
											<option value="TN">Tennessee</option>
											<option value="TX">Texas</option>
											<option value="UT">Utah</option>
											<option value="VT">Vermont</option>
											<option value="VA">Virginia</option>
											<option value="WA">Washington</option>
											<option value="WV">West Virginia</option>
											<option value="WI">Wisconsin</option>
											<option value="WY">Wyoming</option>
	                                    </select>
	                                 </div>
	                               </div>
	                               <div class="col-md-6">
	                                  <div class="form-group"><input type="text" id="" aria-describedby="emailHelp" placeholder="Postal Code" class="form-control" name="edit_postal_code"></div>
	                               </div>
	                               
	                              
	                            </div>
	                            
	                        
	                        <div class="text-center">
	                        <a href="{% url 'jobs' %}"><button type="button" class="btn-success btn" style="margin-right: 15px;">Back</button></a>

	                        <button type="submit" class="btn-success btn">Edit Information</button></div>
	                    </div>
	                    </form>
	             </div>
					  </div>
					</div>


                </div>
             </section>
           {% endblock %}


{% block extrascript %}
<script type="text/javascript">

$('.new-job').click(function(){
	$('.add-job-form').css('display','block');
	$(this).hide();
	$('.existing-job').hide();
})

$('.existing-job').click(function(){
	$('.add-job-form').css('display','none');
	$(this).hide();
	$('.new-job').hide();
})



$('.add-job').click(function(){
	$('.alert-danger').html('');
	var fisrt_name = $("input[name='first_name']").val();
	var phone_number = $("input[name='phone_number']").val();
	var state = $(".state").val();
	var city = $("input[name='city']").val();
	var post_code = $("input[name='post_code']").val();
	var submit = true;

    if (fisrt_name==''|| fisrt_name == null){
        $("input[name='first_name']").css('border', '1px solid red');
          submit = false;
    }
     else{
    	$("input[name='first_name']").css('border', '1px solid #ced4da');
    	submit = true;
    }
    if (phone_number==''|| phone_number == null){
        $("input[name='phone_number']").css('border', '1px solid red');
         submit = false;
    }
    else{
    	$("input[name='phone_number']").css('border', '1px solid #ced4da');
    	submit = true;
    }
    if (city == ''|| city == null){
        $("input[name='city']").css('border', '1px solid red');
          submit = false;
    }
    else{
    	$("input[name='city']").css('border', '1px solid #ced4da');
    	submit = true;
   
     }  
      
    if (state == ''|| state == null){
        $('.state').css('border', '1px solid red');
          submit = false;
    }
    else{
    	$('.state').css('border', '1px solid #ced4da');
    	submit = true;
   
     }
    if (post_code==''|| post_code == null){
        $("input[name='post_code']").css('border', '1px solid red');
          submit = false;
    }
     else{
    	$("input[name='post_code']").css('border', '1px solid #ced4da');
    	submit = true;
    }
     
    if (submit == true){ 
	    $.ajax({

				url: '{% url "jobs" %}',
				type: 'post',
	            data:{  
	               'csrfmiddlewaretoken': '{{csrf_token}}',
	               'fisrt_name':fisrt_name,
	               'phone_number':phone_number,
	               'state': state,
	               'city':city,
	               'post_code':post_code,
	               'last_name':$("input[name='last_name']").val(),
	                'address':$("textarea[name='address']").val(),
	                'customer_id':$("input[name='customer_id']").val(),

	            },
				success: function(response){
					if (response.status == true){
						localStorage.setItem('customer_id',response.customer_id);
						window.location = "{% url 'order' %}"	
					}
					else{
						$('.alert-danger').css('display','block');
						$('.alert-danger').append(response.msg);
					}


				}
			});
	}

})



	$('.find-job').click(function(){
		$('.edit_job_form').css('display','none');
		$('.alert-danger').html('');
		$('input[name="job_id"]').val('');
		$('.alert-danger').css('display','none');
		var last_name = $("input[name='search_last_name']").val();
		var search_contact_number = $("input[name='search_contact_number']").val();
		var search_city = $("input[name='search_city']").val();
		var search_zip = $("input[name='search_zip']").val();

		$.ajax({

			url: '{% url "search_jobs" %}',
			type: 'post',
            data:{  
               'csrfmiddlewaretoken': '{{csrf_token}}',
               'last_name':last_name,
               'search_contact_number':search_contact_number,
               'search_city': search_city,
               'search_zip':search_zip

            },
			success: function(response){
				if (response.status == true){
					$('.edit_job_form').css('display','block');
					$('input[name="job_id"]').val(response.job_id);
					$('input[name="edit_fisrt_name"]').val(response.first_name);
					$('input[name="edit_last_name"]').val(response.last_name);
					$('textarea[name="edit_address"]').val(response.address);
					$('input[name="edit_city"]').val(response.city);
					$('input[name="edit_postal_code"]').val(response.postal_code);
			
				}
				else{
					$('.edit_job_form').css('display','none');
					$('input[name="job_id"]').val('');
					$('.alert-danger').css('display','block');
					$('.alert-danger').append(response.msg);
				}


			}
		});
	})

	$('.clear-field').click(function(){
		$('.edit_job_form').css('display','none');
		$('input[type="text"]').val('');
		$('input[type="email"]').val('');
		$('textarea[name="edit_address"]').val('');

	})
</script>

{% endblock %}

